// Firestore Security Rules for CoffeeExp

rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
  
    // ÇÕ©ëÈgohfn¢¯»¹’Ò&
    match /{document=**} {
      allow read, write: if false;
    }
    
    // æü¶üÇü¿nëüë
    match /users/{userId} {
      // <æü¶ünênÇü¿’­øMïı
      allow create: if request.auth != null;
      allow read, update, delete: if request.auth != null && request.auth.uid == userId;
      
      // æü¶ünµÖ³ì¯·çó³üÒü	xn¢¯»¹
      match /coffees/{coffeeId} {
        allow create, read, update, delete: if request.auth != null && request.auth.uid == userId;
      }
    }
  }
}

// Firebase Storage n»­åêÆ£ëüë
service firebase.storage {
  match /b/{bucket}/o {
    // ÇÕ©ëÈohfn¢¯»¹’Ò&
    match /{allPaths=**} {
      allow read, write: if false;
    }
    
    // æü¶ün¢Ã×íüÉÕ¡¤ëxnëüë
    match /user_files/{userId}/{allPaths=**} {
      // <æü¶ünênÕ¡¤ë’­øMïı
      allow read, write: if request.auth != null && request.auth.uid == userId;
    }
  }
}

/*
»­åêÆ£ëüën-š¬¤É:

1. Firebase³ó½üëkí°¤ó
2. FirestoreÇü¿Ùü¹ > ëüë ¿Ö’x
3. 
nFirestoreëüë’³ÔüWfİX

Øk:
1. Firebase³ó½üë > Storage > ëüë ¿Ö’x
2. 
nStorageëüë’³ÔüWfİX

SŒkˆŠ<UŒ_æü¶ünLênÇü¿k¢¯»¹gM‹ˆFkjŠ~Y
*/